(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t){var n=function(e){return e.split("").map(function(e){return e.charCodeAt(0)})},a=function(e){return("0"+Number(e).toString(16)).substr(-2)},i=function(e){return n(Object({NODE_ENV:"production",PUBLIC_URL:"/minesweeper"}).REACT_APP_JARBLE_CODE).reduce(function(e,t){return e^t},e)};e.exports=function(e){return String(e).split("").map(n).map(i).map(a).join("")}},31:function(e,t,n){e.exports=n(56)},37:function(e,t,n){},38:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(23),l=n.n(r),s=(n(37),n(6)),o=n(24),c=n(25),u=n(28),d=n(26),h=n(4),m=n(29),f=(n(38),n(60)),g=n(58),b=n(61),p=["I'm too young to die","Hey, not too rough","Hurt me plenty","Ultra-Violence","Nightmare!"],v=[10,13,15,25,35],y=[10,15,30,99,300],k=n(10),O=n(57),C=n(59),E=function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return[n[t-1]&&a&&n[t-1][e-1],n[t]&&n[t][e-1],n[t+1]&&a&&n[t+1][e-1],n[t-1]&&n[t-1][e],n[t+1]&&n[t+1][e],n[t-1]&&a&&n[t-1][e+1],n[t]&&n[t][e+1],n[t+1]&&a&&n[t+1][e+1]].filter(function(e){return e})},w=function e(t,n,a){if(!t.isMine&&0===t.count&&!t.flagged&&!t.dunno){var i=E(t.x,t.y,n,!0).filter(function(e){return!a||!a[e.y]||!a[e.y].includes(e.x)}),r=i.filter(function(e){return 0===e.count});if(0===i.length)return[];var l=i.reduce(function(e,t){return e[t.y]?e[t.y].push(t.x):e[t.y]=[t.x],e},a||[]);return Object(b.a)(i.concat(r.map(function(t){return e(t,n,l)})))}return[]},j=Object(O.a)(function(e,t){return Object(s.a)({},e,Object(k.a)({},t.y,Object(s.a)({},e[t.y],Object(k.a)({},t.x,!0))))},{}),S=function(e){var t=v[e],n=y[e],a=Array(Math.pow(t,2)).fill({}),i=function e(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===n)return a;var i=Math.floor(Math.random()*Math.pow(t,2));return a.includes(i)?e(n,a):e(n-1,a.concat([i]))}(n),r=a.map(function(e,t){return{isMine:i.includes(t)}});return Object(C.a)(t,r).map(function(e,t,n){return e.map(function(e,a){var i=E(a,t,n).filter(function(e){return e.isMine}).length;return Object(s.a)({},e,{count:i,clicked:!1,flagged:!1,dunno:!1,x:a,y:t})})})},D=function(e){var t=Object(b.a)(e).filter(function(e){return!e.isMine&&!e.count}).reduce(function(t,n){if(t.board[n.y][n.x].marked)return t;var a=j(w(Object(s.a)({},n,{marked:!0}),e));return{board:t.board.map(function(e,t){return e.map(function(e,n){return a&&a[t]&&a[t][n]?Object(s.a)({},e,{marked:!0}):e})}),chunks:t.chunks+1}},{board:e,chunks:0}),n=Object(b.a)(t.board).filter(function(e){return e.count>0&&!e.marked&&!e.isMine}).length;return t.chunks+n},M=function(e){return Math.floor(Math.pow(e.threeBV,3)*(Math.pow(e.difficulty,3)+1)/((3*e.clicks||1)*(2*e.time||1))*(e.losingCell.x?0:1e4))},T=n(27),x=n.n(T),I=n(13),A=n.n(I),P=x.a.create({baseURL:"http://".concat("cokebustapi.herokuapp.com","/minesweeper")}),N=function(e){return P.get("gameover/".concat(e))},L=["like blue but with more dimensions","blue","green","red","purple","maroon","turquoise","black","darkgray"],R=function(e){return String(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},U=function(e){function t(){var e;Object(o.a)(this,t),e=Object(u.a)(this,Object(d.a)(t).call(this));var n=S(0),a=D(n);return e.state={playing:!1,difficulty:0,selectedDiff:0,gameOver:!0,board:n,threeBV:a,losingCell:{},timer:null,time:0,clicks:0,flags:0,status:"\ud83d\ude42",hint:null,touchTimer:null,skipContextMenu:!1,music:!1,startedAt:null,gameID:null,top50:[],scoreNeighbors:[],key:""},e.handleSelect=e.handleSelect.bind(Object(h.a)(e)),e.startGame=e.startGame.bind(Object(h.a)(e)),e.handleCellRightClick=e.handleCellRightClick.bind(Object(h.a)(e)),e.updateCellState=e.updateCellState.bind(Object(h.a)(e)),e.handleCellClick=e.handleCellClick.bind(Object(h.a)(e)),e.gameOver=e.gameOver.bind(Object(h.a)(e)),e.suspense=e.suspense.bind(Object(h.a)(e)),e.winnerWinnerChickenDinner=e.winnerWinnerChickenDinner.bind(Object(h.a)(e)),e.hint=e.hint.bind(Object(h.a)(e)),e.handlePointerDown=e.handlePointerDown.bind(Object(h.a)(e)),e.handlePointerUp=e.handlePointerUp.bind(Object(h.a)(e)),e.handlePointerLeave=e.handlePointerLeave.bind(Object(h.a)(e)),e.toggleMusic=e.toggleMusic.bind(Object(h.a)(e)),e.setTop50=e.setTop50.bind(Object(h.a)(e)),e.unloadHandler=e.unloadHandler.bind(Object(h.a)(e)),e}return Object(m.a)(t,e),Object(c.a)(t,[{key:"unloadHandler",value:function(e){e.preventDefault(),alert('{AOL "goodbye" SOUND}'),this.state.gameID&&N(this.state.gameID)}},{key:"componentDidMount",value:function(){this.setTop50(),window.addEventListener("beforeunload",this.unloadHandler)}},{key:"componentWillUnmount",value:function(){this.state.timer&&clearInterval(this.state.timer),window.removeEventListener("beforeunload",this.unloadHandler)}},{key:"setTop50",value:function(e){var t=this;P.get("top50").catch(function(){return{data:{rows:[]}}}).then(function(e){var n=e.data;t.setState({top50:n.rows})})}},{key:"handleSelect",value:function(e){this.setState({selectedDiff:Number(e.target.value)})}},{key:"updateCellState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.setState({board:Object(f.a)(Object(g.a)([e.y,e.x]),e,this.state.board)},t)}},{key:"handleCellRightClick",value:function(e){var t=this,n={};e.clicked||this.state.gameOver||(n=!e.flagged&&!e.dunno&&this.state.flags>0?{flagged:!0}:e.flagged&&!e.dunno?{flagged:!1,dunno:!0}:{flagged:!1,dunno:!1},this.updateCellState(Object(s.a)({},e,n),function(){t.setState({flags:y[t.state.difficulty]-Object(b.a)(t.state.board).filter(function(e){return e.flagged}).length})}))}},{key:"gameOver",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("game over man, game over"),this.state.timer&&clearInterval(this.state.timer),N(this.state.gameID).catch(console.log);var n=t?{status:"\ud83e\udd2e"}:{};this.setState(Object(s.a)({gameOver:!0,gameID:null,losingCell:e},n))}},{key:"winnerWinnerChickenDinner",value:function(){var e=this;console.log("winnerWinnerChickenDinner"),this.state.timer&&clearInterval(this.state.timer);var t=this.state.gameID;!function(e,t,n,a,i,r){if(e)P.post("newscore",{id:e,clicks:t,startedAt:n,key:A()(r),endedAt:new Date,board:a,difficulty:i})}(this.state.gameID,this.state.clicks,this.state.startedAt,this.state.board,this.state.difficulty,this.state.key),this.setState({status:"\ud83d\ude0e",gameOver:!0,gameID:null},function(){var n=prompt("\n        your score is ".concat(M(e.state),".\n        not great, not terrible. you definitely didnt apply yourself\n        Whats your name?\n      "));n||(n=prompt("\n          Seriously gimme your name. if you dont give me your name\n          i wont record your score\n        ")),n?function(e,t){return e?P.post("registername",{id:e,name:t}):Promise.resolve({})}(t,n).then(e.setTop50):(alert("wow you are just so humble."),e.gameOver({},!0))})}},{key:"handleCellClick",value:function(e){var t=this;e.clicked||e.flagged||e.dunno||this.state.gameOver||this.updateCellState(Object(s.a)({},e,{clicked:!0}),function(){if(e.isMine)t.gameOver(e);else{var n=j(w(Object(s.a)({},e,{clicked:!0}),t.state.board)),a=t.state.hint&&(n[t.state.hint.y]&&n[t.state.hint.y][t.state.hint.x]||e.y===t.state.hint.y&&e.x===t.state.hint.x)?{hint:null}:{},i=t.state.board.map(function(e,t){return e.map(function(e,a){return n&&n[t]&&n[t][a]?Object(s.a)({},e,{clicked:!e.flagged&&!e.dunno}):e})});(r=t.state.gameID,l=t.state.startedAt,o=t.state.key,r?P.post("recordclick",{id:r,startedAt:l,key:A()(o)}):Promise.resolve()).catch(function(){return alert("something went wrong. your score wont be recorded but you can still play"),t.setState({gameID:null}),{data:{}}}).then(function(e){var n=e.data;t.setState(Object(s.a)({board:i,status:"\ud83d\ude42",clicks:t.state.clicks+1,key:n.lastkey},a),function(){Object(b.a)(t.state.board).filter(function(e){return!e.clicked}).length===y[t.state.difficulty]&&t.winnerWinnerChickenDinner()})})}var r,l,o})}},{key:"startGame",value:function(){var e=this;this.state.timer&&clearInterval(this.state.timer);var t=S(this.state.selectedDiff),n=D(t),a=new Date;this.state.gameID&&N(this.state.gameID),function(e,t,n){return P.post("newgame",{startedAt:e,minClicks:t,difficulty:n}).catch(function(e){return alert("something went wrong. your score wont be recorded but you can still play"),{data:{id:null}}})}(a,n,this.state.selectedDiff).then(function(i){var r=i.data;e.setState({difficulty:e.state.selectedDiff,board:t,threeBV:n,playing:!0,gameOver:!1,losingCell:{},timer:setInterval(function(){return e.setState({time:e.state.time+1})},1e3),time:0,clicks:0,status:"\ud83d\ude42",flags:y[e.state.selectedDiff],hint:null,startedAt:a,gameID:r.id,key:r.lastkey})})}},{key:"suspense",value:function(e){0!==e.button||this.state.gameOver||this.setState({status:"\ud83d\ude32"})}},{key:"hint",value:function(){var e=Object(b.a)(this.state.board).filter(function(e){return!e.isMine&&!e.clicked&&!e.flagged&&!e.dunno&&!e.count});if(0!==e.length){var t=e[Math.floor(Math.random()*e.length)];this.setState({clicks:this.state.clicks+10,hint:t})}}},{key:"handlePointerDown",value:function(e){var t=this;return function(n){if(n.preventDefault(),"mouse"===n.pointerType){if(0===n.button)return t.suspense(n);if(2===n.button)return t.handleCellRightClick(e)}else t.state.gameOver||t.setState({status:"\ud83d\ude32",touchTimer:setTimeout(function(){t.setState({touchTimer:null,status:"\ud83d\ude42",skipContextMenu:!0}),t.handleCellRightClick(e)},450)})}}},{key:"handlePointerUp",value:function(e){var t=this;return function(n){if("mouse"===n.pointerType){if(0===n.button)return t.handleCellClick(e)}else n.preventDefault(),t.state.touchTimer&&(clearInterval(t.state.touchTimer),t.setState({touchTimer:null}),t.handleCellClick(e)),t.state.skipContextMenu&&t.setState({skipContextMenu:!1})}}},{key:"handlePointerLeave",value:function(e){this.state.touchTimer&&(clearInterval(this.state.touchTimer),this.setState({touchTimer:null}))}},{key:"toggleMusic",value:function(){this.state.music?(this.player.pause(),this.player.currentTime=0):this.player.play(),this.setState({music:!this.state.music})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"App"},this.state.gameOver&&i.a.createElement("div",null,i.a.createElement("div",null,"Start new game"),i.a.createElement("select",{value:this.state.selectedDiff,onChange:this.handleSelect},p.map(function(e,t){return i.a.createElement("option",{key:e,value:t},e)})),i.a.createElement("button",{onClick:this.startGame},"GO!")),this.state.playing&&i.a.createElement("div",null,i.a.createElement("div",{className:"hud"},"Score: ",R(M(this.state))),i.a.createElement("div",{className:"playArea"},i.a.createElement("div",{className:"hud"},i.a.createElement("span",{style:{float:"left"}},this.state.flags),i.a.createElement("button",{className:"statusGuy",onClick:this.startGame},this.state.status),i.a.createElement("span",{style:{float:"right"}},String(this.state.time).padStart(3,"0")),i.a.createElement("br",null)),this.state.board.map(function(t){return i.a.createElement("div",{className:"row"},t.map(function(t){return i.a.createElement("button",{className:t.clicked?"clicked":"butt",style:!t.clicked||t.flagged||t.dunno||t.isMine?{}:{color:L[t.count],fontWeight:900},disabled:t.clicked,onMouseUp:function(n){0===n.button&&e.handleCellClick(t)},onMouseDown:e.suspense,onContextMenu:function(n){n.preventDefault(),e.state.skipContextMenu?e.setState({skipContextMenu:!1}):e.handleCellRightClick(t)},onTouchStart:e.handlePointerDown(t),onTouchEnd:e.handlePointerUp(t),onTouchMove:e.handlePointerLeave},e.state.gameOver&&!t.flagged&&t.isMine&&!function(t){return e.state.losingCell.x===t.x&&e.state.losingCell.y===t.y}(t)?"\ud83d\udca9":function(e,t,n){if(e.clicked){if(e.isMine)return"\ud83d\udca5";if(e.count>0)return e.count}else{if(e.flagged)return t?e.isMine?"\u2705":"\u274c":"\ud83d\udea9";if(e.dunno)return"\u2753"}if(!e.clicked&&n&&n.x===e.x&&n.y===e.y)return"\ud83c\ude01"}(t,e.state.gameOver,e.state.hint))}))}),i.a.createElement("button",{disabled:this.state.hint,onClick:this.hint},"Gimme a dang hint"),i.a.createElement("br",null),!this.state.gameOver&&i.a.createElement("div",null,i.a.createElement("audio",{loop:!0,ref:function(t){return e.player=t}},i.a.createElement("source",{src:"spiderman.mp3"})),i.a.createElement("button",{onClick:this.toggleMusic},"PLEASE ",this.state.music?"STOP":"START"," THE MUSIC")),i.a.createElement("div",null,"You like this dang site?",i.a.createElement("br",null),i.a.createElement("a",{href:"https://github.com/jameswillett/minesweeper"},"Here's the dang code"),"."))),i.a.createElement("div",{className:"scoreBoard"},this.state.top50&&i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"RANK"),i.a.createElement("th",null,"NAME"),i.a.createElement("th",null,"SCORE"),i.a.createElement("th",null,"DIFFICULTY"))),i.a.createElement("tbody",null,this.state.top50.map(function(e,t){return i.a.createElement("tr",{key:"".concat(t+1," id ").concat(e.id)},i.a.createElement("td",null,t+1),i.a.createElement("td",null,e.name),i.a.createElement("td",{style:{textAlign:"right",fontFamily:"monospace"}},R(e.score)),i.a.createElement("td",null,p[e.difficulty]," (",e.difficulty+1,")"))})))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[31,1,2]]]);
//# sourceMappingURL=main.507adfd8.chunk.js.map